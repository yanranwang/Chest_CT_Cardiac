{
  "output_dir": "outputs/multi_gpu_cardiac_training",
  "pretrained_model_path": "/dataNAS/people/joycewyr/Chest_CT_Cardiac/merlin/models/checkpoints/i3_resnet_clinical_longformer_best_clip_04-02-2024_23-21-36_epoch_99.pt",
  "num_cardiac_metrics": 2,
  "epochs": 30,
  "batch_size": 18,
  "learning_rate": 1e-4,
  "weight_decay": 1e-5,
  "optimizer": "adamw",
  "loss_function": "mse",
  "scheduler": {
    "type": "cosine",
    "eta_min": 1e-6
  },
  "freeze_encoder": false,
  "grad_clip": 1.0,
  "device": "cuda",
  "seed": 42,
  "num_workers": 8,
  "log_interval": 10,
  "save_interval": 5,
  "use_tensorboard": true,
  "drop_last": true,
  
  "progress_bar": true,
  "show_gpu_memory": true,
  "show_eta": true,
  "detailed_metrics": true,
  
  "train_val_split": 0.8,
  "split_method": "random",
  
  "csv_path": "/dataNAS/people/joycewyr/Chest_CT_Cardiac/filtered_echo_chestCT_data_filtered_chest_data.csv",
  "required_columns": ["basename", "folder"],
  "cardiac_metric_columns": [],
  "metadata_columns": ["patient_id"],
  
  "base_path": "/dataNAS/data/ct_data/ct_scans",
  "image_path_template": "{base_path}/stanford_{folder}/{basename}.nii.gz",
  "check_file_exists": false,
  
  "remove_missing_files": true,
  "remove_duplicates": true,
  
  "use_fast_loader": true,
  "preprocessed_data_dir": "/dataNAS/people/joycewyr/Chest_CT_Cardiac/outputs/cardiac_training_fast",
  "preprocess_batch_size": 32,
  "cache_config": {
    "enable_cache": true,
    "cache_size": 500,
    "preload_train_data": false,
    "preload_val_data": false
  },
  
  "_comments": {
    "multi_gpu_optimization": "=== 多GPU训练优化配置 ===",
    "batch_size_note": "批量大小设为48 (每GPU约16)，适合3张RTX8000",
    "learning_rate_note": "学习率调整为2e-4，适合较大批量",
    "num_workers_note": "工作进程数设为24，充分利用88核CPU",
    "cache_size_note": "缓存大小设为500，为多GPU训练预留内存",
    "freeze_encoder_note": "设为false以获得更好的多GPU训练效果",
    "save_interval_note": "更频繁保存检查点，防止长训练中断",
    "performance_tips": [
      "确保使用 CUDA_VISIBLE_DEVICES=0,1,2",
      "监控GPU利用率和内存使用",
      "根据实际性能调整batch_size和num_workers",
      "可以根据需要调整preprocess_batch_size"
    ]
  }
} 